{% load static %}
{% load compress %}

<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rejestracja – MIKO</title>

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Rubik" />
    {% compress css %}
    <link rel="stylesheet" href="{% static 'style.css' %}">
    <link rel="stylesheet" href="{% static 'accounts/auth.css' %}">
    {% endcompress %}
    {% compress js %}
    <script src="{% static 'script.js' %}"></script>
    {% endcompress %}
</head>

<body>
{% include "header.html" %}

<main class="auth-page">
    <div class="auth-shell">
        <section class="auth-panel auth-panel--hero">
            <img class="auth-hero-logo" src="{% static 'logoDark.svg' %}" alt="MIKO">
            <h1 class="auth-title" style="color: white;">Dołącz do MIKO!</h1>
            <p class="auth-subtitle">
                Utwórz konto, aby korzystać ze wszystkich funkcji systemu.
            </p>
        </section>

        <section class="auth-panel">
            <h1 class="auth-title">Rejestracja</h1>

            <form class="auth-form" method="POST" action="/signup/">
                {% csrf_token %}

                <div class="auth-row">
                    <div class="auth-field">
                        <label for="first_name">Imię</label>
                        <input class="auth-input" type="text" id="first_name" name="first_name" required>
                    </div>
                    <div class="auth-field">
                        <label for="last_name">Nazwisko</label>
                        <input class="auth-input" type="text" id="last_name" name="last_name" required>
                    </div>
                </div>
            
                <div class="auth-field">
                    <label for="username">Nazwa użytkownika</label>
                    <input class="auth-input" type="text" id="username" name="username" placeholder="np. marek123" required>
                </div>
                <div class="auth-field">
                    <label for="email">Email</label>
                    <input class="auth-input" type="email" id="email" name="email" placeholder="np. marek@mikomath.org" required>
                </div>
            
                <div class="auth-row">
                    <div class="auth-field">
                        <label for="password">Hasło</label>
                        <input class="auth-input" type="password" id="password" name="password" placeholder="••••••••••" required>
                    </div>
                    <div class="auth-field">
                        <label for="confirmPassword">Powtórz hasło</label>
                        <input class="auth-input" type="password" id="confirmPassword" name="confirmPassword" placeholder="••••••••••" required>
                    </div>
                </div>

                {% if pwd_help_texts %}
                    <div class="auth-help">
                        <ul>
                            {% for txt in pwd_help_texts %}
                                <li>{{ txt }}</li>
                            {% endfor %}
                        </ul>
                    </div>
                {% endif %}

                <div class="auth-row">
                    <div class="auth-field">
                        <label for="region">Województwo</label>
                        <select class="auth-select" id="region" name="region" required>
                            <option value="" disabled selected>Wybierz z listy</option>
                            {% for code, label in region_choices %}
                                <option value="{{ code }}">{{ label }}</option>
                            {% endfor %}
                        </select>
                    </div>

                    <div class="auth-field">
                        <label for="date_of_birth">Data urodzenia</label>
                        <input class="auth-input" type="date" id="date_of_birth" name="date_of_birth" min="1900-01-01" required>
                    </div>
                </div>
            
                {% if custom_message %}
                    <div class="flash">{{ custom_message }}</div>
                {% endif %}

                <div class="auth-actions">
                    <button class="btn btn-primary" type="submit">Utwórz konto</button>
                    <a class="btn btn-secondary" href="/">Wróć na stronę</a>
                </div>

                <div class="auth-links">
                    Masz już konto? <a href="../signin/">Zaloguj się</a>
                </div>
            </form>

            <script>
                document.addEventListener('DOMContentLoaded', function () {
                    const form = document.getElementById('registrationForm') || document.querySelector('form');
                    if (!form) return;

                    form.addEventListener('submit', function (event) {
                        const password = document.getElementById('password').value;
                        const confirmPassword = document.getElementById('confirmPassword').value;
                        if (password !== confirmPassword) {
                            event.preventDefault();
                            alert('Hasła się nie zgadzają!');
                        }
                    });
                });
            </script>
        </section>
    </div>
</main>

{% include "footer.html" %}
</body>
</html>
